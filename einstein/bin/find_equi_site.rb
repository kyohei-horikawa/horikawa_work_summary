n_atom = 200
einstein=[
  [ 0, n_atom, -2460.88889,    4.05071,    2.55214,    4.58286],
  [ 1, n_atom, -2460.88979,    2.07643,    1.39000,    3.35286],
  [ 2, n_atom, -2460.88888,    3.38429,    2.69214,    4.40000],
  [ 3, n_atom, -2460.88901,    4.10500,    1.65286,    4.53643],
  [ 4, n_atom, -2460.88871,    4.51357,    2.64357,    4.33571],
  [ 5, n_atom, -2460.88869,    4.51214,    2.64429,    4.33429],
  [ 6, n_atom, -2460.88833,    3.70714,    3.70786,    3.33429],
  [ 7, n_atom, -2460.88869,    2.64071,    4.51429,    4.33714],
  [ 8, n_atom, -2460.88887,    4.05143,    2.55214,    4.58357],
  [ 9, n_atom, -2460.88867,    3.30357,    3.59286,    3.75929],
  [10, n_atom, -2460.88978,    1.38786,    2.07429,    3.35429],
  [11, n_atom, -2460.88887,    2.54857,    4.05214,    4.57857],
  [12, n_atom, -2460.88870,    2.64357,    4.51357,    4.33429],
  [13, n_atom, -2460.88904,    1.65429,    4.10714,    4.53500],
  [14, n_atom, -2460.88901,    4.10214,    1.65000,    4.53500],
  [15, n_atom, -2460.88867,    3.59429,    3.30429,    3.76071],
  [16, n_atom, -2460.88903,    1.65143,    4.10643,    4.53643],
  [17, n_atom, -2460.88867,    3.30429,    3.59214,    3.76143],
  [18, n_atom, -2460.88867,    3.59286,    3.30214,    3.76071],
  [19, n_atom, -2460.88979,    1.38929,    2.07571,    3.35286],
  [20, n_atom, -2460.88889,    2.68857,    3.38500,    4.40214],
  [21, n_atom, -2460.88977,    2.07786,    1.38786,    3.35500],
  [22, n_atom, -2460.88890,    3.38429,    2.69143,    4.40071],
  [23, n_atom, -2460.88890,    2.69286,    3.38500,    4.40214],
  [24, n_atom, -2460.88887,    2.55571,    4.05000,    4.58143],
  [25, n_atom, -2460.88819,    5.17071,    3.26286,    4.80929],
  [26, n_atom, -2460.88828,    4.33571,    3.86286,    4.31000],
  [27, n_atom, -2460.88821,    5.17214,    3.26000,    4.81071],
  [28, n_atom, -2460.88822,    4.53286,    2.88357,    4.68000],
  [29, n_atom, -2460.88832,    5.17429,    2.93000,    5.51429],
  [30, n_atom, -2460.88821,    3.25500,    5.17214,    4.81357],
  [31, n_atom, -2460.88819,    3.25643,    5.17071,    4.80857],
  [32, n_atom, -2460.88834,    2.93000,    5.17571,    5.51286],
  [33, n_atom, -2460.88809,    4.65714,    4.12571,    4.05786],
  [34, n_atom, -2460.88828,    3.86286,    4.33786,    4.30929],
  [35, n_atom, -2460.88809,    4.65857,    4.12286,    4.05643],
  [36, n_atom, -2460.88828,    3.60429,    3.23714,    4.42000],
  [37, n_atom, -2460.88832,    5.17429,    2.93000,    5.51214],
  [38, n_atom, -2460.88831,    3.60571,    3.24214,    4.42000],
  [39, n_atom, -2460.88830,    3.24143,    3.60857,    4.42000],
  [40, n_atom, -2460.88808,    4.12286,    4.66000,    4.05714],
  [41, n_atom, -2460.88821,    2.88143,    4.53214,    4.68357],
  [42, n_atom, -2460.88826,    4.33643,    3.86286,    4.31214],
  [43, n_atom, -2460.88832,    2.93214,    5.17571,    5.51357],
  [44, n_atom, -2460.88808,    4.12500,    4.66000,    4.05857],
  [45, n_atom, -2460.88826,    3.86357,    4.33643,    4.30857],
  [46, n_atom, -2460.88823,    2.88357,    4.53429,    4.68143],
  [47, n_atom, -2460.88831,    3.23643,    3.60643,    4.42000],
  [48, n_atom, -2460.88824,    4.53429,    2.88286,    4.68143],
  [49, n_atom, -2460.88808,    2.97643,    2.98000,    4.56500],
  [50, n_atom, -2460.88822,    4.53286,    2.88357,    4.68000],
  [51, n_atom, -2460.88835,    2.93214,    5.17643,    5.51429],
  [52, n_atom, -2460.88807,    2.97786,    2.97929,    4.56500],
  [53, n_atom, -2460.88824,    2.88357,    4.53429,    4.68214],
  [54, n_atom, -2460.88826,    3.86214,    4.33786,    4.30857],
  [55, n_atom, -2460.88820,    3.25500,    5.17143,    4.81214],
  [56, n_atom, -2460.88821,    5.17143,    3.26143,    4.81000],
  [57, n_atom, -2460.88830,    3.23643,    3.60500,    4.41857],
  [58, n_atom, -2460.88832,    3.60500,    3.23786,    4.42071],
  [59, n_atom, -2460.88808,    4.12286,    4.65929,    4.05643],
  [60, n_atom, -2460.88811,    4.12286,    4.66071,    4.05929],
  [61, n_atom, -2460.88833,    2.93000,    5.17500,    5.51286],
  [62, n_atom, -2460.88834,    5.17429,    2.93143,    5.51429],
  [63, n_atom, -2460.88809,    4.66000,    4.12286,    4.05643],
  [64, n_atom, -2460.88807,    4.65643,    4.12500,    4.05786],
  [65, n_atom, -2460.88823,    4.53429,    2.88214,    4.68143],
  [66, n_atom, -2460.88822,    3.25714,    5.17143,    4.81000],
  [67, n_atom, -2460.88831,    3.60571,    3.24214,    4.42000],
  [68, n_atom, -2460.88827,    4.33714,    3.86214,    4.31143],
  [69, n_atom, -2460.88832,    5.17429,    2.92929,    5.51500],
  [70, n_atom, -2460.88830,    3.24071,    3.61000,    4.42071],
  [71, n_atom, -2460.88829,    4.33714,    3.86286,    4.31286],
  [72, n_atom, -2460.88823,    2.88143,    4.53286,    4.68357],
  [73, n_atom, -2460.88821,    5.17071,    3.26000,    4.81214],
  [74, n_atom, -2460.88828,    3.86357,    4.33714,    4.30929],
  [75, n_atom, -2460.88977,    1.38929,    2.07571,    3.35214],
  [76, n_atom, -2460.88867,    3.30357,    3.59286,    3.75929],
  [77, n_atom, -2460.88886,    2.54929,    4.05214,    4.57857],
  [78, n_atom, -2460.88977,    2.07643,    1.38786,    3.35286],
  [79, n_atom, -2460.88867,    3.59286,    3.30071,    3.76071],
  [80, n_atom, -2460.88903,    1.65429,    4.10643,    4.53500],
  [81, n_atom, -2460.88976,    1.38929,    2.07357,    3.35357],
  [82, n_atom, -2460.88891,    2.69286,    3.38571,    4.40214],
  [83, n_atom, -2460.88869,    2.64214,    4.51286,    4.33429],
  [84, n_atom, -2460.88901,    4.10500,    1.65214,    4.53714],
  [85, n_atom, -2460.88872,    4.51357,    2.64429,    4.33571],
  [86, n_atom, -2460.88887,    4.05000,    2.55214,    4.58214],
  [87, n_atom, -2460.88888,    3.38429,    2.69214,    4.40000],
  [88, n_atom, -2460.88887,    4.05000,    2.55214,    4.58214],
  [89, n_atom, -2460.88832,    3.70714,    3.70786,    3.33357],
  [90, n_atom, -2460.88870,    4.51286,    2.64429,    4.33429],
  [91, n_atom, -2460.88889,    3.38429,    2.69143,    4.40000],
  [92, n_atom, -2460.88871,    2.64071,    4.51500,    4.33714],
  [93, n_atom, -2460.88901,    4.10357,    1.64929,    4.53500],
  [94, n_atom, -2460.88867,    3.59357,    3.30500,    3.76071],
  [95, n_atom, -2460.88888,    2.68857,    3.38500,    4.40143],
  [96, n_atom, -2460.88977,    2.07929,    1.38786,    3.35500],
  [97, n_atom, -2460.88903,    1.65143,    4.10643,    4.53643],
  [98, n_atom, -2460.88889,    2.55643,    4.05143,    4.58143],
  [99, n_atom, -2460.88866,    3.30429,    3.59286,    3.76143],
  [100, n_atom, -2460.88978,    1.38786,    2.07786,    3.35429],
  [101, n_atom, -2460.88903,    4.10643,    1.65143,    4.53643],
  [102, n_atom, -2460.88867,    3.30429,    3.59429,    3.76071],
  [103, n_atom, -2460.88869,    2.64429,    4.51214,    4.33429],
  [104, n_atom, -2460.88890,    2.69143,    3.38429,    4.40071],
  [105, n_atom, -2460.88887,    4.05214,    2.55000,    4.57857],
  [106, n_atom, -2460.88887,    4.05000,    2.55571,    4.58143],
  [107, n_atom, -2460.88867,    3.30214,    3.59286,    3.76071],
  [108, n_atom, -2460.88979,    1.39000,    2.07643,    3.35286],
  [109, n_atom, -2460.88888,    2.69214,    3.38429,    4.40000],
  [110, n_atom, -2460.88867,    3.59286,    3.30357,    3.75929],
  [111, n_atom, -2460.88870,    4.51357,    2.64357,    4.33429],
  [112, n_atom, -2460.88887,    2.55214,    4.05143,    4.58214],
  [113, n_atom, -2460.88871,    2.64357,    4.51357,    4.33571],
  [114, n_atom, -2460.88833,    3.70786,    3.70714,    3.33429],
  [115, n_atom, -2460.88867,    3.59214,    3.30429,    3.76143],
  [116, n_atom, -2460.88889,    3.38500,    2.68857,    4.40214],
  [117, n_atom, -2460.88890,    3.38500,    2.69286,    4.40214],
  [118, n_atom, -2460.88902,    1.65000,    4.10357,    4.53500],
  [119, n_atom, -2460.88889,    2.55214,    4.05071,    4.58286],
  [120, n_atom, -2460.88904,    4.10714,    1.65429,    4.53500],
  [121, n_atom, -2460.88977,    2.07429,    1.38786,    3.35357],
  [122, n_atom, -2460.88977,    2.07571,    1.38929,    3.35214],
  [123, n_atom, -2460.88871,    4.51429,    2.64143,    4.33714],
  [124, n_atom, -2460.88901,    1.65286,    4.10500,    4.53643],
  [125, n_atom, -2460.88821,    3.26000,    5.17214,    4.81071],
  [126, n_atom, -2460.88809,    4.66000,    4.12429,    4.05857],
  [127, n_atom, -2460.88831,    3.60643,    3.23643,    4.42000],
  [128, n_atom, -2460.88822,    2.88357,    4.53286,    4.68000],
  [129, n_atom, -2460.88808,    2.98000,    2.97643,    4.56500],
  [130, n_atom, -2460.88823,    2.88143,    4.53286,    4.68143],
  [131, n_atom, -2460.88809,    4.12429,    4.65857,    4.05786],
  [132, n_atom, -2460.88828,    4.33643,    3.86286,    4.30929],
  [133, n_atom, -2460.88832,    2.93000,    5.17429,    5.51429],
  [134, n_atom, -2460.88821,    5.17214,    3.25500,    4.81357],
  [135, n_atom, -2460.88821,    4.53214,    2.88143,    4.68357],
  [136, n_atom, -2460.88826,    3.86286,    4.33643,    4.31214],
  [137, n_atom, -2460.88808,    4.12286,    4.66000,    4.05571],
  [138, n_atom, -2460.88832,    2.93000,    5.17429,    5.51214],
  [139, n_atom, -2460.88829,    3.23714,    3.60429,    4.42143],
  [140, n_atom, -2460.88820,    5.17071,    3.25714,    4.80857],
  [141, n_atom, -2460.88834,    5.17571,    2.93000,    5.51286],
  [142, n_atom, -2460.88826,    4.33643,    3.86357,    4.30857],
  [143, n_atom, -2460.88823,    4.53429,    2.88357,    4.68143],
  [144, n_atom, -2460.88828,    3.86286,    4.33714,    4.31000],
  [145, n_atom, -2460.88819,    3.26286,    5.17071,    4.80929],
  [146, n_atom, -2460.88808,    4.66000,    4.12286,    4.05714],
  [147, n_atom, -2460.88830,    3.60714,    3.24143,    4.42000],
  [148, n_atom, -2460.88831,    3.24214,    3.60571,    4.42000],
  [149, n_atom, -2460.88832,    5.17571,    2.93214,    5.51357],
  [150, n_atom, -2460.88822,    5.17143,    3.25714,    4.81000],
  [151, n_atom, -2460.88832,    3.23786,    3.60500,    4.42071],
  [152, n_atom, -2460.88834,    2.93143,    5.17429,    5.51429],
  [153, n_atom, -2460.88824,    4.53429,    2.88357,    4.68214],
  [154, n_atom, -2460.88809,    4.12286,    4.66000,    4.05643],
  [155, n_atom, -2460.88821,    3.26143,    5.17143,    4.81000],
  [156, n_atom, -2460.88833,    5.17500,    2.93000,    5.51286],
  [157, n_atom, -2460.88830,    3.61000,    3.24071,    4.42071],
  [158, n_atom, -2460.88829,    3.86286,    4.33714,    4.31286],
  [159, n_atom, -2460.88823,    4.53286,    2.88143,    4.68357],
  [160, n_atom, -2460.88820,    5.17143,    3.25500,    4.81214],
  [161, n_atom, -2460.88811,    4.66071,    4.12571,    4.05929],
  [162, n_atom, -2460.88807,    4.12500,    4.65786,    4.05786],
  [163, n_atom, -2460.88826,    4.33786,    3.86214,    4.30857],
  [164, n_atom, -2460.88823,    2.88214,    4.53429,    4.68143],
  [165, n_atom, -2460.88807,    2.97929,    2.97786,    4.56500],
  [166, n_atom, -2460.88808,    4.65929,    4.12286,    4.05643],
  [167, n_atom, -2460.88828,    4.33714,    3.86357,    4.30929],
  [168, n_atom, -2460.88827,    3.86214,    4.33714,    4.31143],
  [169, n_atom, -2460.88831,    3.24214,    3.60571,    4.42000],
  [170, n_atom, -2460.88830,    3.60500,    3.23643,    4.42000],
  [171, n_atom, -2460.88833,    2.92929,    5.17429,    5.51571],
  [172, n_atom, -2460.88822,    2.88214,    4.53286,    4.68000],
  [173, n_atom, -2460.88835,    5.17643,    2.93214,    5.51429],
  [174, n_atom, -2460.88821,    3.26000,    5.17214,    4.81214],
  [175, n_atom, -2460.88977,    1.38786,    2.07929,    3.35500],
  [176, n_atom, -2460.88891,    3.38571,    2.69286,    4.40214],
  [177, n_atom, -2460.88869,    4.51286,    2.64214,    4.33429],
  [178, n_atom, -2460.88977,    1.38786,    2.07643,    3.35286],
  [179, n_atom, -2460.88886,    4.05214,    2.54929,    4.57857],
  [180, n_atom, -2460.88872,    2.64429,    4.51357,    4.33571],
  [181, n_atom, -2460.88901,    1.65214,    4.10500,    4.53714],
  [182, n_atom, -2460.88901,    1.64929,    4.10357,    4.53500],
  [183, n_atom, -2460.88867,    3.30500,    3.59357,    3.76071],
  [184, n_atom, -2460.88977,    2.07571,    1.38929,    3.35214],
  [185, n_atom, -2460.88871,    4.51500,    2.64071,    4.33714],
  [186, n_atom, -2460.88889,    2.69143,    3.38429,    4.40143],
  [187, n_atom, -2460.88889,    4.05143,    2.55643,    4.58143],
  [188, n_atom, -2460.88903,    4.10643,    1.65143,    4.53643],
  [189, n_atom, -2460.88888,    2.69214,    3.38429,    4.40000],
  [190, n_atom, -2460.88887,    2.55214,    4.05000,    4.58214],
  [191, n_atom, -2460.88867,    3.30071,    3.59286,    3.76071],
  [192, n_atom, -2460.88903,    4.10643,    1.65429,    4.53500],
  [193, n_atom, -2460.88977,    2.07357,    1.38929,    3.35429],
  [194, n_atom, -2460.88866,    3.59286,    3.30429,    3.76143],
  [195, n_atom, -2460.88887,    2.55214,    4.05000,    4.58214],
  [196, n_atom, -2460.88867,    3.59286,    3.30357,    3.75929],
  [197, n_atom, -2460.88870,    2.64429,    4.51286,    4.33429],
  [198, n_atom, -2460.88833,    3.70857,    3.70714,    3.33357],
  [199, n_atom, -2460.88888,    3.38500,    2.68857,    4.40143]]


einstein.sort! do |a,b| a[5] <=> b[5] end

unique = []
equi_site = []
einstein.each_with_index do |ele0,i|
  puts " %3d %5.3f %5.3f %5.3f" % [ele0[0],ele0[3],ele0[4],ele0[5]]
  j = 0
  unique.each do |ele1|
    if (ele0[5]-ele1[5]).abs <0.01
      break
    end
    j += 1
  end
  if j>=unique.size
    unique << ele0
    equi_site << [ele0[0]]
  else
    equi_site[j] << ele0[0]
  end
end

puts ""
unique.each_with_index do |ele, i|
  puts " %3d %5.3f %5.3f %5.3f" % [ele[0],ele[3],ele[4],ele[5]]
  p equi_site[i].sort
end

